CSV Validation Checklist

1. Column & Schema Checks
   - All required columns exist.
   - Required fields are not missing.
   - Field types match expected (int, float, str).
   - Numeric fields respect min/max bounds:
       - src_port, dst_port: 0–65535
       - protocol: 0–255
       - packet_count, byte_count: ≥ 0
       - avg_packet_size: 1–65535
       - first_packet_index, last_packet_index: ≥ 0
       - duration: ≥ 0

2. IP Address Checks
   - Valid IPv4/IPv6
   - src_ip ≠ dst_ip
   - No multicast addresses.
   - No broadcast (255.255.255.255) addresses.
   - No loopback addresses (127.0.0.1 / ::1)

3. Protocol & Port Checks
   - protocol exists in IANA_PROTOCOLS (1=ICMP, 6=TCP, 17=UDP).
   - protocol_name matches protocol.
   - TCP/UDP flows have valid ports.
   - ICMP flows have src_port = dst_port = 0.

4. Packet & Byte Checks
   - packet_count ≥ 0.
   - byte_count ≥ packet_count.
   - If packet_count = 0 → byte_count = 0.
   - avg_packet_size ≈ byte_count / packet_count (tolerance ±5).

5. Packet Index Checks
   - first_packet_index ≤ last_packet_index.

6. Duration Checks
   - duration ≥ 0.
   - Single packet flows: duration ≤ 0.001s.
   - Multiple packets: duration ≠ 0.
   - Multi-packet flows > 1 hour flagged.

7. Protocol-Port Sanity Checks
   - DNS (port 53) → duration < 10s.
   - HTTPS (port 443) → packet_count ≥ 2.

8. Duplicate Detection
   - No duplicate flows (key: src_ip, dst_ip, src_port, dst_port, protocol, first_packet_index).

Output
   - Adds is_valid column (True/False).
   - Adds error_reason column (list of validation errors).

==================
Validation Tests:

CSV Columns:
src_ip,dst_ip,src_port,dst_port,protocol,packet_count,byte_count,avg_packet_size,first_packet_index,last_packet_index,duration,protocol_name

Test Rows:

# 1. Valid flow (should pass)
142.250.117.119,192.168.0.21,443,49666,17,244,271560,1112.95,159,3563,1.333,UDP

# 2. Invalid IP (src_ip)
999.999.999.999,192.168.0.21,443,49666,17,244,271560,1112.95,159,3563,1.333,UDP

# 3. src_ip = dst_ip (loopback)
192.168.0.10,192.168.0.10,443,49666,17,244,271560,1112.95,159,3563,1.333,UDP

# 4. Multicast src_ip
224.0.0.1,192.168.0.21,443,49666,17,244,271560,1112.95,159,3563,1.333,UDP

# 5. Broadcast dst_ip
142.250.117.119,255.255.255.255,443,49666,17,244,271560,1112.95,159,3563,1.333,UDP

# 6. Invalid protocol number
142.250.117.119,192.168.0.21,443,49666,99,244,271560,1112.95,159,3563,1.333,UNKNOWN

# 7. Protocol name mismatch
142.250.117.119,192.168.0.21,443,49666,17,244,271560,1112.95,159,3563,1.333,TCP

# 8. ICMP with ports != 0
142.250.117.119,192.168.0.21,1,1,1,1,64,64,0,0,0.0,ICMP

# 9. packet_count=0 but byte_count>0
142.250.117.119,192.168.0.21,443,49666,17,0,10,0,159,159,0.0,UDP

# 10. byte_count < packet_count
142.250.117.119,192.168.0.21,443,49666,17,100,50,0.5,159,259,1.0,UDP

# 11. avg_packet_size inconsistent
142.250.117.119,192.168.0.21,443,49666,17,10,1000,50,159,168,1.0,UDP

# 12. last_packet_index < first_packet_index
142.250.117.119,192.168.0.21,443,49666,17,10,1000,100,200,150,1.0,UDP

# 13. single packet but duration > 0.001
142.250.117.119,192.168.0.21,443,49666,17,1,100,100,159,159,1.0,UDP

# 14. multiple packets but duration = 0
142.250.117.119,192.168.0.21,443,49666,17,10,1000,100,159,168,0.0,UDP

# 15. DNS port duration too long
142.250.117.119,192.168.0.21,53,12345,17,10,1000,100,159,168,15.0,UDP

# 16. HTTPS with packet_count < 2
142.250.117.119,192.168.0.21,443,12345,17,1,100,100,159,159,0.5,UDP

# 17. Duplicate flow
142.250.117.119,192.168.0.21,443,49666,17,244,271560,1112.95,159,3563,1.333,UDP

# 18. Multiple errors: invalid IP, loopback, port out of range
192.168.1.300,192.168.1.300,70000,443,1,0,10,10.0,5,3,0.0,ICMP

Results:
- Row 1 → valid, should pass.
- Rows 2–16 → each triggers a specific validation error.
- Row 17 → duplicate of row 1 to test duplicate detection.
- Row 18 → multiple errors

